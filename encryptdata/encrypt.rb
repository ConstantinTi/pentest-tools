#!/usr/bin/env ruby
require 'digest'
require 'securerandom'

# Enter the short version of the company name you are generating the archive for.
print "### Please enter a short version of the company's name [<blank>]: "

short = gets.chomp

print "### Generating password ... "
pw = SecureRandom.base64(15)
puts '[ OK ]'

# Generating archive
print '### Generating archive ... '
%x(7z a output/Pentest-#{short}.7z -p#{pw} input/*)

puts '[ OK ]'

print '### Creating SHA256 checksum ... '
file_path = 'output/PITSA-' + short + '.7z'
sha256 = Digest::SHA256.file file_path
puts '[ OK ]'

puts "### The used password is: #{pw}"
puts "### The SHA256 checksum of the archive is: #{sha256}"
